---
title: "Untitled"
output: html_document
---

```{r, include=FALSE}
#Package Libraries
#install.packages("xaringan")
library(xaringan)
#install.packages("servr")
library(servr)
library(rio)
library(tidyverse)
library(ggplot2)
library(ggridges)
library(ggsci)
library(ggthemes)
library(car)
library(gridExtra)
#install.packages("ggpubr")
library(ggpubr)
#install.packages("showtext")
library(showtext)
#install.packages("prediction")
library(prediction)
font_add_google("Merriweather", "M", regular.wt = 400)
font_add_google("Josefin Sans", "JS", regular.wt = 400)
font_add_google("Work Sans", "WS", regular.wt = 400)
font_add_google("EB Garamond", "G", regular.wt = 400)
font_add_google("Raleway", "Rw", regular.wt = 400)
font_add_google("Averia Sans Libre", "Ave", regular.wt = 400)
font_add_google("Nova Round", "Nova", regular.wt = 400)
font_add_google("Carrois Gothic", "CG", regular.wt=400)
font_add_google("Jost", "Jost", regular.wt=400)
font_add_google("Oswald", "O", regular.wt=400)
font_add_google("Alfa Slab One", "ASO", regular.wt=400)
font_add_google("Passion One", "PO", regular.wt=400)
font_add_google("Roboto Condensed", "RC", regular.wt=400)
font_add_google("Yanone Kaffeesatz", "YF", regular.wt=600)
showtext_opts(dpi = 300)
showtext_auto(enable = TRUE)
#install.packages("devtools")
library(devtools)
#install_github("ryanburge/socsci")
library(socsci)
#install.packages("paletteer")
library(paletteer)
#install.packages("jtools")
library(jtools)
#install.packages("interactions")
library(interactions)
#install.packages("patchwork")
library(patchwork)
#install.packages("psych")
library(psych)
#install.packages("MASS")
library(MASS)
#install.packages("ragg")
library(ragg)
#install.packages("systemfonts")
library(systemfonts)
#install.packages("gtools")
library(gtools)
library(margins)
library(interactions)

```


```{r, include=FALSE}
#Import Data, if you don't have access and want it, please email me at dennen_j1@denison.edu
library(readr)
m21 <- read_csv("March_2021_deidentified_565.csv")

#Make all variables lowercase
m21 <- m21 %>% rename_all(tolower) 
rm(March_2021_deidentified_565)

library(scales)
show_col(pal_futurama("planetexpress")(12))

```

```{r, include=FALSE}
#Demographic stuff
#Basic renaming
m21 <- m21 %>% mutate(sexo=q55,
                      faminc=q58,
                      ed=q59,
                      year=q62,
                      pid8=q3)

#Gender stuff
m21 <- m21 %>% mutate(q54_1=car::recode(q54_1, "NA=0"),
                      q54_2=car::recode(q54_2, "NA=0"),
                      q54_3=car::recode(q54_3, "NA=0"),
                      q54_4=car::recode(q54_4, "NA=0"))

m21 <- m21 %>% mutate(gender4= frcode(q54_1==1 ~ "Male",
                                      q54_2==1 ~ "Female",
                                      q54_3==1 ~ "Transgender",
                                      q54_4==1 ~ "Non-binary"))

#Sexual orientation
m21 <- m21 %>% mutate(sexo=frcode(q55==1 ~ "Heterosexual",
                                  q55==2 ~ "Homosexual",
                                  q55==3 ~ "Bisexual",
                                  q55==4 ~ "Pansexual",
                                  q55==5 ~ "Asexual",
                                  q55==6 ~ "Other"))

#Graduation year
m21 <- m21 %>% mutate(yearf=frcode(year==1 ~ "2021",
                                   year==2 ~ "2022",
                                   year==3 ~ "2023",
                                   year==4 ~ "2024"))

#Race
m21 <- m21 %>% mutate(white=car::recode(q57_1, "NA=0"),
                      hispanic=car::recode(q57_2, "NA=0"),
                      black=car::recode(q57_3, "NA=0"),
                      asian=car::recode(q57_4, "NA=0"),
                      other=car::recode(q57_5, "NA=0"))

#A single race variable (e.g., white only)
m21 <- m21 %>% mutate(race=case_when(black==1 ~ "Black",
                                     asian==1 & (black!=1 & hispanic!=1) ~ "Asian",
                                     hispanic==1 ~ "Hispanic",
                                     other==1 & (black!=1 & hispanic!=1 & asian!=1)~ "Other",
                                     white==1 & (black!=1 & hispanic!=1 & asian!=1 & other!=1) ~ "White"))
m21 %>% ct(race)


```


```{r, include=FALSE}
#Ideology stuff
#Changing NAs to zeroes
m21 <- m21 %>% mutate(q61_1=car::recode(q61_1, "NA=0"),
                      q61_2=car::recode(q61_2, "NA=0"),
                      q61_3=car::recode(q61_3, "NA=0"),
                      q61_4=car::recode(q61_4, "NA=0"),
                      q61_5=car::recode(q61_5, "NA=0"),
                      q61_6=car::recode(q61_6, "NA=0"),
                      q61_7=car::recode(q61_7, "NA=0"))
#Proglib
m21 <- m21 %>% mutate(proglib=frcode(q61_1==1 & q61_2==0 ~ "Progressive\nOnly",
                                     q61_1==0 & q61_2==1 ~ "Liberal\nOnly",
                                     q61_1==1 & q61_2==1 ~ "Both Prog\n& Lib",
                                     q61_4==1|q61_5==1|q61_3==1|q61_6==1|q61_7==1 ~ "Other"))


#Making all ideologies (with proglib)
m21 <- m21 %>% mutate(ideo=frcode(q61_1==1 & q61_2==0 ~ "Progressive\nOnly",
                                  q61_1==0 & q61_2==1 ~ "Liberal\nOnly",
                                  q61_1==1 & q61_2==1 ~ "Both Prog\n& Lib",
                                  q61_4==1 ~ "Conservative",
                                  q61_5==1 ~ "Alt-right",
                                  q61_3==1 ~ "Moderate",
                                  q61_6==1 ~ "Libertarian",
                                  q61_7==1 ~ "Other"))
#Total number of people choosing one of the ideologies
m21 <- m21 %>% mutate(ideotot=frcode(q61_1==1 ~ "Progressive",
                                     q61_2==1 ~ "Liberal",
                                     q61_4==1 ~ "Conservative",
                                     q61_5==1 ~ "Alt-right",
                                     q61_3==1 ~ "Moderate",
                                     q61_6==1 ~ "Libertarian",
                                     q61_7==1 ~ "Other"))

#Political party
m21 <- m21 %>% mutate(pid8f=frcode(pid8==1 ~ "Strong\nDemocrat",
                                   pid8==2 ~ "Democrat",
                                   pid8==3 ~ "Lean\nDemocrat",
                                   pid8==4 ~ "Independent",
                                   pid8==5 ~ "Lean\nRepublican",
                                   pid8==6 ~ "Republican",
                                   pid8==7 ~ "Strong\nRepublican",
                                   pid8==8 ~ "Other"))

#Simplifying party into 4 categories
m21 <- m21 %>% mutate(pid4f=frcode(pid8==1 | pid8==2 | pid8==3 ~ "Democrat",
                                   pid8==4 ~ "Independent",
                                   pid8==5 | pid8==6 | pid8==7 ~ "Republican",
                                   pid8==8 ~ "Other"))

#Partisan strength
m21 <- m21 %>% mutate(pidst=car::recode(pid8, "1=4; 2=3; 3=2; 4=1; 5=2; 6=3; 7=4; 8=1"))
m21 <- m21 %>% mutate(pidstf=frcode(pid8==1 | pid8==7 ~ "Strong\nPartisan",
                                    pid8==2 | pid8==6 ~ "Partisan",
                                    pid8==3 | pid8==5 ~ "Lean Partisan",
                                    pid8==4 ~ "Independent",
                                    pid8==8 ~ "Other"))

```

```{r}
m21 <- m21 %>% mutate(q6r=6-q6)
m21 <- m21 %>% mutate(q6rf=frcode(q6r==1 ~ "Strongly\nDisagree",
                                  q6r==2 ~ "Somewhat\nDisagree",
                                  q6r==3 ~ "Neither Agree\nNor Disagree",
                                  q6r==4 ~ "Somewhat\nAgree",
                                  q6r==5 ~ "Strongly\nAgree"))
#Making it a 0-1 variable
m21 <- m21 %>% mutate(q6rc=car::recode(q6r, "1:3=0; 4:5=1")) 
m21 <- m21 %>% mutate(q6lab=frcode(q6rc==0 ~ "Disagree/No Opinion",
                                   q6rc==1 ~ "Agree"))
#Three point variable
m21 <- m21 %>% mutate(q6lab3=frcode(q6r==1|q6r==2 ~ "Disagree",
                                    q6r==3 ~ "Neither Agree\nnor Disagree",
                                    q6r==4|q6r==5 ~ "Agree"))

#Proud/Embarrassed of US Democracy
m21 <- m21 %>% mutate(q39_1f=frcode(q39_1== 1 ~ "Very Embarrassed", 
                                    q39_1== 2 ~ "Somewhat Embarrassed", 
                                    q39_1== 3 ~ "Neither Embarrassed\nnor Proud",
                                    q39_1== 4 ~ "Somewhat Proud",
                                    q39_1== 5 ~ "Very Proud"))


#Social media platforms
m21 <- m21 %>% mutate(q13_1=car::recode(q13_1, "NA=0"),
                      q13_2=car::recode(q13_2, "NA=0"),
                      q13_3=car::recode(q13_3, "NA=0"),
                      q13_4=car::recode(q13_4, "NA=0"),
                      q13_5=car::recode(q13_5, "NA=0"),
                      q13_6=car::recode(q13_6, "NA=0"),
                      q13_7=car::recode(q13_7, "NA=0"),
                      q13_8=car::recode(q13_8, "NA=0"),
                      q13_9=car::recode(q13_9, "NA=0"),
                      q13_10=car::recode(q13_10, "NA=0"))



```


```{r}
#Overall stress this semester
m21 %>% mean_ci(q20_1, ci=0.84)
#Overall stress last semester
m21 %>% mean_ci(q20_2, ci=0.84)

#Academics
m21 %>% mean_ci(q21_1)
#Personal finances
m21 %>% mean_ci(q21_2)
#Family
m21 %>% mean_ci(q21_3)
#Mental Health
m21 %>% mean_ci(q21_4)
#Relationships with Friends
m21 %>% mean_ci(q21_5)
#Roommates
m21 %>% mean_ci(q21_6)
#Covid
m21 %>% mean_ci(q21_7)
#What am I eating next
m21 %>% mean_ci(q21_8)
#How much am I eating next
m21 %>% mean_ci(q21_9)

```





